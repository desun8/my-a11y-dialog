const t=['a[href]:not([tabindex^="-"]):not([inert])','area[href]:not([tabindex^="-"]):not([inert])',"input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])",'iframe:not([tabindex^="-"]):not([inert])','audio:not([tabindex^="-"]):not([inert])','video:not([tabindex^="-"]):not([inert])','[contenteditable]:not([tabindex^="-"]):not([inert])','[tabindex]:not([tabindex^="-"]):not([inert])'],e=t=>[...t.parentElement.children].filter((e=>e!==t&&"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName));class s{constructor(e,s){this.container=e,this.btnClose=s,this.isOpen=!1,this.tempBeforeFocusedElm=void 0,this.dialog=this.container.querySelector("dialog, [role='dialog'], [role='alertdialog']"),this.focusableElms=Array.from(this.container.querySelectorAll(t.join(","))),this.firstFocusableElm=this.focusableElms[0],this.lastFocusableElm=this.focusableElms[this.focusableElms.length-1],this.siblings=this.getSiblings(),this.addEvents()}getSiblings(){return e(this.container).filter((t=>"true"!==t.getAttribute("aria-hidden")))}static setVisible(t,e){((t,e)=>{t.setAttribute("aria-hidden",`${e}`)})(t,e)}setVisibleSiblings(t){this.siblings.forEach((e=>s.setVisible(e,t)))}restoreFocus(){this.tempBeforeFocusedElm&&(this.tempBeforeFocusedElm.focus(),this.tempBeforeFocusedElm=void 0)}show(){this.isOpen||(console.log("open"),this.isOpen=!0,this.tempBeforeFocusedElm=document.activeElement,this.dialog.setAttribute("open",""),s.setVisible(this.container,!1),s.setVisible(this.btnClose,!1),this.setVisibleSiblings(!0),this.firstFocusableElm.focus())}hide(){this.isOpen&&(console.log("close"),this.isOpen=!1,this.restoreFocus(),this.dialog.removeAttribute("open"),s.setVisible(this.container,!0),this.setVisibleSiblings(!1))}handleBackwardTab(t){document.activeElement===this.firstFocusableElm&&(t.preventDefault(),this.lastFocusableElm.focus())}handleForwardTab(t){document.activeElement===this.lastFocusableElm&&(t.preventDefault(),this.firstFocusableElm.focus())}handleKeyDown(t){if(this.isOpen)switch(t.key){case"Tab":if(1===this.focusableElms.length){t.preventDefault();break}t.shiftKey?(this.handleBackwardTab(t),console.log("focus move to prev element")):(this.handleForwardTab(t),console.log("focus move to next element"));break;case"Escape":this.hide()}}addEvents(){this.container.addEventListener("keydown",this.handleKeyDown.bind(this)),this.btnClose.addEventListener("click",this.hide.bind(this))}}class i extends s{constructor(t,e,s="",i=""){super(t,e),this.openLabel=s,this.closeLabel=i,this.timestamp=0,this.deep=0,this.tree=[]}getBtnParent(t){let e,s=0,i=[];for(;!t.some((t=>t===e))&&(e=void 0===e?this.btnClose:e.parentElement,e!==document.body);)s++,i.push(e);this.deep=s,this.tree=i}getBtnSiblings(){const t=[...this.tree.slice(0,this.deep-1)];let s=[];return t.forEach((t=>{const i=e(t);s=[...s,...i]})),s}getSiblings(){const t=super.getSiblings();this.getBtnParent(t);return[...t.filter((t=>t!==this.tree[this.deep-1])),...this.getBtnSiblings()]}allowClick(){return Date.now()-this.timestamp>=50}show(){!this.isOpen&&this.allowClick()&&(super.show(),this.btnClose.setAttribute("aria-label",this.closeLabel),this.timestamp=Date.now())}hide(){this.isOpen&&this.allowClick()&&(super.hide(),this.btnClose.setAttribute("aria-label",this.openLabel),this.timestamp=Date.now())}handleBackwardTab(t){document.activeElement===this.firstFocusableElm?(t.preventDefault(),this.btnClose.focus(),console.log("focus to btnClose")):document.activeElement===this.btnClose&&(t.preventDefault(),this.lastFocusableElm.focus(),console.log("focus to last"))}handleForwardTab(t){document.activeElement===this.lastFocusableElm?(t.preventDefault(),this.btnClose.focus(),console.log("focus to btnClose")):document.activeElement===this.btnClose&&(t.preventDefault(),this.firstFocusableElm.focus(),console.log("focus to first"))}addEvents(){super.addEvents(),this.btnClose.addEventListener("keydown",this.handleKeyDown.bind(this))}}const n=(t,e)=>{console.info(`%c${t}`,`\n  background: ${"cornflowerblue"};\n  padding: 1em;\n  font-weight: 700`),console.info(e)};export default class{constructor(t,e,o="",l=""){this.container=t,this.btnClose=e,this.openLabel=o,this.closeLabel=l;const a=this.btnClose.closest(`#${this.container.id}`);n("isBtnCloseInside",a),n("this.btnClose",this.btnClose),n("this.container.id",this.container.id),this.dialog=a?new s(this.container,this.btnClose):new i(this.container,this.btnClose,this.openLabel,this.closeLabel),this.show=this.dialog.show.bind(this.dialog)}}
//# sourceMappingURL=a11y-dialog.esm.js.map
