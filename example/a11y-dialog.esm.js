var e,t;(e=window.document).getElementById("livereloadscript")||((t=e.createElement("script")).async=1,t.src="//"+(window.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(t));const s=['a[href]:not([tabindex^="-"]):not([inert])','area[href]:not([tabindex^="-"]):not([inert])',"input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])",'iframe:not([tabindex^="-"]):not([inert])','audio:not([tabindex^="-"]):not([inert])','video:not([tabindex^="-"]):not([inert])','[contenteditable]:not([tabindex^="-"]):not([inert])','[tabindex]:not([tabindex^="-"]):not([inert])'],i=e=>[...e.parentElement.children].filter((t=>t!==e&&"SCRIPT"!==t.tagName&&"STYLE"!==t.tagName));class n{constructor(e,t){this.container=e,this.btnClose=t,this.isOpen=!1,this.tempBeforeFocusedElm=void 0,this.dialog=this.container.querySelector("dialog, [role='dialog'], [role='alertdialog']"),this.focusableElms=Array.from(this.container.querySelectorAll(s.join(","))),this.firstFocusableElm=this.focusableElms[0],this.lastFocusableElm=this.focusableElms[this.focusableElms.length-1],this.siblings=this.getSiblings(),this.addEvents()}getSiblings(){return i(this.container).filter((e=>"true"!==e.getAttribute("aria-hidden")))}static setVisible(e,t){((e,t)=>{e.setAttribute("aria-hidden",`${t}`)})(e,t)}setVisibleSiblings(e){this.siblings.forEach((t=>n.setVisible(t,e)))}restoreFocus(){this.tempBeforeFocusedElm&&(this.tempBeforeFocusedElm.focus(),this.tempBeforeFocusedElm=void 0)}show(){this.isOpen||(console.log("open"),this.isOpen=!0,this.tempBeforeFocusedElm=document.activeElement,this.dialog.setAttribute("open",""),n.setVisible(this.container,!1),n.setVisible(this.btnClose,!1),this.setVisibleSiblings(!0),this.firstFocusableElm.focus())}hide(){this.isOpen&&(console.log("close"),this.isOpen=!1,this.restoreFocus(),this.dialog.removeAttribute("open"),n.setVisible(this.container,!0),this.setVisibleSiblings(!1))}handleBackwardTab(e){document.activeElement===this.firstFocusableElm&&(e.preventDefault(),this.lastFocusableElm.focus())}handleForwardTab(e){document.activeElement===this.lastFocusableElm&&(e.preventDefault(),this.firstFocusableElm.focus())}handleKeyDown(e){if(this.isOpen)switch(e.key){case"Tab":if(1===this.focusableElms.length){e.preventDefault();break}e.shiftKey?(this.handleBackwardTab(e),console.log("focus move to prev element")):(this.handleForwardTab(e),console.log("focus move to next element"));break;case"Escape":this.hide()}}addEvents(){this.container.addEventListener("keydown",this.handleKeyDown.bind(this)),this.btnClose.addEventListener("click",this.hide.bind(this))}}class o extends n{constructor(e,t,s="",i=""){super(e,t),this.openLabel=s,this.closeLabel=i,this.timestamp=0,this.deep=0,this.tree=[]}getBtnParent(e){let t,s=0,i=[];for(;!e.some((e=>e===t))&&(t=void 0===t?this.btnClose:t.parentElement,t!==document.body);)s++,i.push(t);this.deep=s,this.tree=i}getBtnSiblings(){const e=[...this.tree.slice(0,this.deep-1)];let t=[];return e.forEach((e=>{const s=i(e);t=[...t,...s]})),t}getSiblings(){const e=super.getSiblings();this.getBtnParent(e);return[...e.filter((e=>e!==this.tree[this.deep-1])),...this.getBtnSiblings()]}allowClick(){return Date.now()-this.timestamp>=50}show(){!this.isOpen&&this.allowClick()&&(super.show(),this.btnClose.setAttribute("aria-label",this.closeLabel),this.timestamp=Date.now())}hide(){this.isOpen&&this.allowClick()&&(super.hide(),this.btnClose.setAttribute("aria-label",this.openLabel),this.timestamp=Date.now())}handleBackwardTab(e){document.activeElement===this.firstFocusableElm?(e.preventDefault(),this.btnClose.focus(),console.log("focus to btnClose")):document.activeElement===this.btnClose&&(e.preventDefault(),this.lastFocusableElm.focus(),console.log("focus to last"))}handleForwardTab(e){document.activeElement===this.lastFocusableElm?(e.preventDefault(),this.btnClose.focus(),console.log("focus to btnClose")):document.activeElement===this.btnClose&&(e.preventDefault(),this.firstFocusableElm.focus(),console.log("focus to first"))}addEvents(){super.addEvents(),this.btnClose.addEventListener("keydown",this.handleKeyDown.bind(this))}}const l=(e,t)=>{console.info(`%c${e}`,`\n  background: ${"cornflowerblue"};\n  padding: 1em;\n  font-weight: 700`),console.info(t)};export default class{constructor(e,t,s="",i=""){this.container=e,this.btnClose=t,this.openLabel=s,this.closeLabel=i;const a=this.btnClose.closest(`#${this.container.id}`);l("isBtnCloseInside",a),l("this.btnClose",this.btnClose),l("this.container.id",this.container.id),this.dialog=a?new n(this.container,this.btnClose):new o(this.container,this.btnClose,this.openLabel,this.closeLabel),this.show=this.dialog.show.bind(this.dialog)}}
//# sourceMappingURL=a11y-dialog.esm.js.map
